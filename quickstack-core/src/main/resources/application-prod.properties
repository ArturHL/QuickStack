# ============================================
# PRODUCCIÓN - QuickStack Core Backend
# ============================================

spring.application.name=QuickStack-Core

# ============================================
# DATABASE - PostgreSQL (Neon)
# ============================================
# IMPORTANTE: Las credenciales vienen de variables de entorno
spring.datasource.url=${DATABASE_URL}
spring.datasource.username=${DATABASE_USERNAME:postgres}
spring.datasource.password=${DATABASE_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# Connection pool (HikariCP)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ============================================
# JPA / HIBERNATE
# ============================================
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# ============================================
# FLYWAY
# ============================================
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
spring.flyway.validate-on-migrate=true

# ============================================
# JWT CONFIGURATION
# ============================================
# IMPORTANTE: En producción, jwt.secret debe ser una clave fuerte desde variable de entorno
jwt.secret=${JWT_SECRET:CHANGE_THIS_IN_PRODUCTION_USE_ENV_VAR}
jwt.expiration-ms=${JWT_EXPIRATION_MS:3600000}

# ============================================
# SPRING SECURITY
# ============================================
# Headers de seguridad
spring.security.headers.frame=DENY
spring.security.headers.content-type=nosniff
spring.security.headers.xss=1; mode=block

# ============================================
# ACTUATOR (Health checks para Render)
# ============================================
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true

# ============================================
# SERVER
# ============================================
server.port=${PORT:8080}
server.shutdown=graceful
server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html,text/xml,text/plain

# Error handling
server.error.include-message=never
server.error.include-stacktrace=never
server.error.include-exception=false

# ============================================
# LOGGING
# ============================================
logging.level.root=INFO
logging.level.com.quickstack=INFO
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=INFO
logging.level.org.hibernate.SQL=WARN

# Log pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# ============================================
# CORS (si es necesario para frontend)
# ============================================
# Descomentar y configurar según necesites
# cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:3000}
